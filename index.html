<!DOCTYPE html>
<html>
  <head>
    <meta charset=utf-8>
    <title>Cube Simulator</title>
    <style>
      body { margin: 0; }
      canvas { width: 100%; height: 100% }
      button {width: 80px}
      .UI {position: fixed}
      .green{background: green}
      .red{background: red}
      .blue{background: blue}
      .orange{background: orange}
      .white{background: white}
      .yellow{background: yellow}

    </style>
  </head>
  <body>
    <div class ="UI">
      <button type="button" class='red'
        onclick="rubikView.rotate('F');">CW</button>
      <button type="button" class='red'
        onclick="rubikView.rotate('F*');">CCW</button>
      <button type="button" class='orange'
        onclick="rubikView.rotate('B');">CW</button>
      <button type="button" class='orange'
        onclick="rubikView.rotate('B*');">CCW</button>
      <button type="button" class='blue'
        onclick="rubikView.rotate('R');">CW</button>
      <button type="button" class='blue'
        onclick="rubikView.rotate('R*');">CCW</button>
      <button type="button" class='green'
        onclick="rubikView.rotate('L');">CW</button>
      <button type="button" class='green'
        onclick="rubikView.rotate('L*');">CCW</button>
      <button type="button" class='white'
        onclick="rubikView.rotate('U');">CW</button>
      <button type="button" class='white'
        onclick="rubikView.rotate('U*');">CCW</button>
      <button type="button" class='yellow'
        onclick="rubikView.rotate('D');">CW</button>
      <button type="button" class='yellow'
        onclick="rubikView.rotate('D*');">CCW</button>
      <button type="button"
        onclick="scramble()">Scramble</button>
      <button type="button"
        onclick="restore()">Restore</button>
    </div>
    <script src="js/three.js"></script>
    <script src="js/Tween.min.js"></script>
    <script src="js/TrackballControls.js"></script>
    <script src="js/loaders/DDSLoader.js"></script>
		<script src="js/loaders/MTLLoader.js"></script>
		<script src="js/loaders/OBJLoader.js"></script>
    <script src="js/cube-sim/init.js"></script>
    <script src="js/cube-sim/piece.js"></script>
    <script src="js/cube-sim/socket.js"></script>
    <script src="js/cube-sim/center.js"></script>
    <script src="js/cube-sim/corner.js"></script>
    <script src="js/cube-sim/edge.js"></script>
    <script src="js/cube-sim/coloredCube.js"></script>
    <script src="js/cube-sim/cube333.js"></script>
    <script src="js/cube-sim/cube333Visual.js"></script>

    <script>
      //scene setup
      var scene = new THREE.Scene();
      var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );

      var renderer = new THREE.WebGLRenderer();
      renderer.setSize( window.innerWidth, window.innerHeight );
      renderer.setClearColor('#282c34');
      document.body.appendChild( renderer.domElement );
      window.addEventListener( 'resize', onWindowResize, false );
      
      // Controls
      controls = new THREE.TrackballControls( camera );
      controls.rotateSpeed = 2.5;
      controls.noZoom = true;
      controls.noPan = true;
      controls.staticMoving = true;
      controls.dynamicDampingFactor = 0.3;
      controls.keys = [ 65, 83, 68 ];

      //add light
      var ambient = new THREE.AmbientLight( 0x444444 );
      scene.add( ambient );

      var light = new THREE.PointLight( 0xffeedd );
      light.position.set( 0, 1, -1 ).normalize();
      light.power = 25;
      camera.add( light );
      scene.add(camera);

      camera.position.z = 5;
      //Draw cube
      var rubik = new CUBES.Cube333();
      var rubikView = new CUBES.Cube333.View(rubik,scene);

      //Drawing loop

      animate();

      function animate() {
        requestAnimationFrame( animate );
        render();
        controls.update();
      }

      function render() {
        TWEEN.update();
        renderer.render( scene, camera );
      }
      //Button controls for now
      function restore(){
        scene.remove(rubik.object3D);
        scene.remove(rubikView.object3D);
        rubik = new CUBES.Cube333();
        rubikView = new CUBES.Cube333.View(rubik,scene);
        rubik.initRenderer();
      }
      var moves =['U','D','L','R','F','B'];
      function scramble(){
        var algorithm = '';
        for (var i = 0; i < 30; i++) {
          var index = Math.getRandomIntInclusive(0,moves.length-1);
          algorithm+=moves[index] + ' ';
        }
        algorithm = algorithm.slice(0, -1); //remove last space
        rubikView.algorithm(algorithm, 30);
      }
      function onWindowResize() {

				windowHalfX = window.innerWidth / 2;
				windowHalfY = window.innerHeight / 2;

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}
    </script>
  </body>
</html>
